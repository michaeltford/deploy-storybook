import{_}from"./preload-helper-PPVm8Dsz.js";import{J as S,w as x}from"./index-CmvF348R.js";import"./index-CvKDCtrJ.js";import"./iframe-mGP4b_Fh.js";import"./index-BiBgeh3u.js";import"./index-DTwpo8e8.js";import"./client-BMu68Vok.js";import"./index-CXJVXQGg.js";/**
 * @license @sheetxl/io - IO - Import/Export Libraries for SheetXL. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const B=async(i,d)=>{const{trimLeadingBlankRow:p=!0,trimLeadingBlankColumn:m=!0,ignoreHidden:c=!1,sheetKey:o=null,papaParseConfig:g={}}=d||{},w=await _(()=>import("./bnT-Gz8Pp4pjhdny-D87AXZsq.js"),[],import.meta.url).then(s=>s.p);if(!i)throw new Error("workbook must be specified");let n=null;if(o===null?n=i.getSelectedSheet():typeof o=="number"?n=i.getSheets().getItems()[o]:typeof o=="string"&&(n=i.getSheets().getByName(o)),!n)throw new Error("invalid sheetKey specified");let u=null;const l=[];let t=null,e=n.getUsedRange({ignoreHidden:c});if(!e)throw new Error("Nothing to export");if(!p||!m){const s=p?e.getRowStart():0,a=m?e.getColumnStart():0;e=e.getOffsetTo(s,a)}e.forEach((s,a)=>{const f=a.getCoords(),E=a.getCell();u!==f.rowIndex&&(t&&l.push(t),t=[],u=f.rowIndex);const y=E.toTextUnformatted()??"";t.push(y)},{includeEmpty:!0,address:null}),t&&l.push(t);const h={...g},r=w.unparse(l,h);return new TextEncoder().encode(r).buffer},V=async(i,d)=>{const{papaParseConfig:p,setValuesOptions:m,createWorkbookOptions:c}=d??{},o=d?.progress,g=o?.onProgress,w=await _(()=>import("./bnT-Gz8Pp4pjhdny-D87AXZsq.js"),[],import.meta.url).then(r=>r.p),n=new TextDecoder().decode(i);let u=-1;const l=new S(c),t=l.getSelectedSheet().getEntireRange().startIncrementalUpdates({orientation:x.Orientation.Row});let e=0;const h={...p,transform:(r,s)=>{p?.transform&&(r=p.transform(r,s));const a=s;a===0&&u++;let f=r??"";return t.pushAt(u,a,f),e++,e%1e5==0&&g?.(e),r}};return w.parse(n,h).data,t.apply({textParser:!0,...m}),l};export{V as readBufferCSV,B as writeBufferCSV};
