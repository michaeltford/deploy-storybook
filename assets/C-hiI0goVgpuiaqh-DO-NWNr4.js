const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BDKNXcPPkYQKShJT-B2hUIgn8.js","./index-CvKDCtrJ.js","./preload-helper-PPVm8Dsz.js","./iframe-mGP4b_Fh.js","./index-BiBgeh3u.js","./index-DTwpo8e8.js","./client-BMu68Vok.js","./index-CmvF348R.js","./index-CXJVXQGg.js"])))=>i.map(i=>d[i]);
import{_ as Qt}from"./preload-helper-PPVm8Dsz.js";import{H as Rt,M as _t,j as Ce,m as ke,T as Ht,_ as xt,X as Ae,J as De,N as Ee,w as Ie,n as Pe}from"./index-CmvF348R.js";import{t as re,x as Oe,o as Ve,H as ae,d as Le}from"./index-CvKDCtrJ.js";import"./index-BiBgeh3u.js";import"./iframe-mGP4b_Fh.js";import"./index-DTwpo8e8.js";import"./index-CXJVXQGg.js";import"./client-BMu68Vok.js";/**
 * @license @sheetxl/io - IO - Import/Export Libraries for SheetXL. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const de=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",Ne=new RegExp(`^[${de}][${`-${de}.0-9·̀-ͯ‿-⁀`}]*$`,"u"),Re=[32,10,13,9];function ye(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}const pe="A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",$e=new RegExp(`^[${pe}][${`-${pe}.0-9·̀-ͯ‿-⁀`}]*$`,"u");function xe(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}const rt=function(o){return o===32||o===10||o===13||o===9},_e=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},Gt=ye,ge=function(o){return ye(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256},we=Re,Me=Ne,je=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},He=xe,Xe=function(o){return xe(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256},Fe=$e,ie="http://www.w3.org/XML/1998/namespace",Bt="http://www.w3.org/2000/xmlns/",We={__proto__:null,xml:ie,xmlns:Bt},Be={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},L=-1,bt=-2,tt=13,$t=33,ft=10,Ot=60,Ft=61,F=62,q=63,Wt=93,oe=o=>o===34||o===39,ve=[34,39],qe=[...ve,91,F],ze=[...ve,Ot,Wt],Ue=[Ft,q,...we],Ge=[...we,F,38,Ot];function le(o,t,s){switch(t){case"xml":s!==ie&&o.fail(`xml prefix must be bound to ${ie}.`);break;case"xmlns":s!==Bt&&o.fail(`xmlns prefix must be bound to ${Bt}.`)}switch(s){case Bt:o.fail(t===""?`the default namespace may not be set to ${s}.`:`may not assign a prefix (even "xmlns") to the URI ${Bt}.`);break;case ie:switch(t){case"xml":break;case"":o.fail(`the default namespace may not be set to ${s}.`);break;default:o.fail("may not assign the xml namespace to another prefix.")}}}const Qe=o=>Fe.test(o),Je=o=>Me.test(o),fe={xmldecl:"xmlDeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};class Ze{constructor(t){this.i=0,this.prevI=0,this.opt=t??{},this.fragmentOpt=!!this.opt.fragment;const s=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,s){this.nameStartCheck=He,this.nameCheck=Xe,this.isName=Qe,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns={__proto__:null,...We};const i=this.opt.additionalNamespaces;i!=null&&((function(a,n){for(const c of Object.keys(n))le(a,c,n[c])})(this,i),Object.assign(this.ns,i))}else this.nameStartCheck=Gt,this.nameCheck=ge,this.isName=Je,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:t}=this;this.state=t?tt:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=t,this.xmlDeclPossible=!t,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:s}=this.opt;if(s===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");s="1.0"}this.setXMLVersion(s),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(Be),this.readyHandler?.()}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(t,s){this[fe[t]]=s}off(t){this[fe[t]]=void 0}makeError(t){let s=this.fileName??"";return this.trackPosition&&(s.length>0&&(s+=":"),s+=`${this.line}:${this.column}`),s.length>0&&(s+=": "),new Error(s+t)}fail(t){const s=this.makeError(t),i=this.errorHandler;if(i===void 0)throw s;return i(s),this}write(t){if(this.closed)return this.fail("cannot write after close.");let s=!1;t===null?(s=!0,t=""):typeof t=="object"&&(t=t.toString()),this.carriedFromPrevious!==void 0&&(t=`${this.carriedFromPrevious}${t}`,this.carriedFromPrevious=void 0);let i=t.length;const a=t.charCodeAt(i-1);!s&&(a===13||a>=55296&&a<=56319)&&(this.carriedFromPrevious=t[i-1],i--,t=t.slice(0,i));const{stateTable:n}=this;for(this.chunk=t,this.i=0;this.i<i;)n[this.state].call(this);return this.chunkPosition+=i,s?this.end():this}close(){return this.write(null)}getCode10(){const t=this.chunk,s=this.i;if(this.prevI=s,this.i++,s>=t.length)return L;const i=t.charCodeAt(s);if(this.column++,i<55296){if(i>=32||i===9)return i;switch(i){case ft:return this.line++,this.column=0,this.positionAtNewLine=this.position,ft;case 13:return t.charCodeAt(s+1)===ft&&(this.i=s+2),this.line++,this.column=0,this.positionAtNewLine=this.position,bt;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;const a=65536+1024*(i-55296)+(t.charCodeAt(s+1)-56320);return this.i=s+2,a>1114111&&this.fail("disallowed character."),a}getCode11(){const{chunk:t,i:s}=this;if(this.prevI=s,this.i=s+1,s>=t.length)return L;const i=t.charCodeAt(s);if(this.column++,i<55296){if(i>31&&i<127||i>159&&i!==8232||i===9)return i;switch(i){case ft:return this.line++,this.column=0,this.positionAtNewLine=this.position,ft;case 13:{const n=t.charCodeAt(s+1);n!==ft&&n!==133||(this.i=s+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,bt;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;const a=65536+1024*(i-55296)+(t.charCodeAt(s+1)-56320);return this.i=s+2,a>1114111&&this.fail("disallowed character."),a}getCodeNorm(){const t=this.getCode();return t===bt?ft:t}unGet(){this.i=this.prevI,this.column--}captureTo(t){let{i:s}=this;const{chunk:i}=this;for(;;){const a=this.getCode(),n=a===bt,c=n?ft:a;if(c===L||t.includes(c))return this.text+=i.slice(s,this.prevI),c;n&&(this.text+=`${i.slice(s,this.prevI)}
`,s=this.i)}}captureToChar(t){let{i:s}=this;const{chunk:i}=this;for(;;){let a=this.getCode();switch(a){case bt:this.text+=`${i.slice(s,this.prevI)}
`,s=this.i,a=ft;break;case L:return this.text+=i.slice(s),!1}if(a===t)return this.text+=i.slice(s,this.prevI),!0}}captureNameChars(){const{chunk:t,i:s}=this;for(;;){const i=this.getCode();if(i===L)return this.name+=t.slice(s),L;if(!ge(i))return this.name+=t.slice(s,this.prevI),i===bt?ft:i}}skipSpaces(){for(;;){const t=this.getCodeNorm();if(t===L||!rt(t))return t}}setXMLVersion(t){this.currentXMLVersion=t,t==="1.0"?(this.isChar=_e,this.getCode=this.getCode10):(this.isChar=je,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const t=this.i,s=this.skipSpaces();switch(this.prevI!==t&&(this.xmlDeclPossible=!1),s){case Ot:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case L:break;default:this.unGet(),this.state=tt,this.xmlDeclPossible=!1}}sDoctype(){const t=this.captureTo(qe);switch(t){case F:this.doctypeHandler?.(this.text),this.text="",this.state=tt,this.doctype=!0;break;case L:break;default:this.text+=String.fromCodePoint(t),t===91?this.state=4:oe(t)&&(this.state=3,this.q=t)}}sDoctypeQuote(){const t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.q=null,this.state=2)}sDTD(){const t=this.captureTo(ze);t!==L&&(this.text+=String.fromCodePoint(t),t===Wt?this.state=2:t===Ot?this.state=6:oe(t)&&(this.state=5,this.q=t))}sDTDQuoted(){const t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.state=4,this.q=null)}sDTDOpenWaka(){const t=this.getCodeNorm();switch(this.text+=String.fromCodePoint(t),t){case 33:this.state=7,this.openWakaBang="";break;case q:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const t=String.fromCodePoint(this.getCodeNorm()),s=this.openWakaBang+=t;this.text+=t,s!=="-"&&(this.state=s==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),this.state=t===45?10:8}sDTDCommentEnded(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),t===F?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(q)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),t===F&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:t}=this;const{chunk:s}=this;t:for(;;)switch(this.getCode()){case bt:this.entity+=`${s.slice(t,this.prevI)}
`,t=this.i;break;case 59:{const{entityReturnState:i}=this,a=this.entity+s.slice(t,this.prevI);let n;this.state=i,a===""?(this.fail("empty entity name."),n="&;"):(n=this.parseEntity(a),this.entity=""),i===tt&&this.textHandler===void 0||(this.text+=n);break t}case L:this.entity+=s.slice(t);break t}}sOpenWaka(){const t=this.getCode();if(Gt(t))this.state=34,this.unGet(),this.xmlDeclPossible=!1;else switch(t){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case q:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=tt,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){const t=this.getCodeNorm();t===45?(this.state=19,this.commentHandler?.(this.text),this.text=""):(this.text+=`-${String.fromCodePoint(t)}`,this.state=17)}sCommentEnded(){const t=this.getCodeNorm();t!==F?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(t)}`,this.state=17):this.state=tt}sCData(){this.captureToChar(Wt)&&(this.state=21)}sCDataEnding(){const t=this.getCodeNorm();t===Wt?this.state=22:(this.text+=`]${String.fromCodePoint(t)}`,this.state=20)}sCDataEnding2(){const t=this.getCodeNorm();switch(t){case F:this.cdataHandler?.(this.text),this.text="",this.state=tt;break;case Wt:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(t)}`,this.state=20}}sPIFirstChar(){const t=this.getCodeNorm();this.nameStartCheck(t)?(this.piTarget+=String.fromCodePoint(t),this.state=24):t===q||rt(t)?(this.fail("processing instruction without a target."),this.state=t===q?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(t),this.state=24)}sPIRest(){const{chunk:t,i:s}=this;for(;;){const i=this.getCodeNorm();if(i===L)return void(this.piTarget+=t.slice(s));if(!this.nameCheck(i)){this.piTarget+=t.slice(s,this.prevI);const a=i===q;a||rt(i)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=a?$t:27):this.state=a?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(i));break}}}sPIBody(){if(this.text.length===0){const t=this.getCodeNorm();t===q?this.state=26:rt(t)||(this.text=String.fromCodePoint(t))}else this.captureToChar(q)&&(this.state=26)}sPIEnding(){const t=this.getCodeNorm();if(t===F){const{piTarget:s}=this;s.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),this.piHandler?.({target:s,body:this.text}),this.piTarget=this.text="",this.state=tt}else t===q?this.text+="?":(this.text+=`?${String.fromCodePoint(t)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const t=this.skipSpaces();t!==q?t!==L&&(this.state=28,this.name=String.fromCodePoint(t)):this.state=$t}sXMLDeclName(){const t=this.captureTo(Ue);if(t===q)return this.state=$t,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(rt(t)||t===Ft){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=t===Ft?30:29}}sXMLDeclEq(){const t=this.getCodeNorm();if(t===q)return this.state=$t,void this.fail("XML declaration is incomplete.");rt(t)||(t!==Ft&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const t=this.getCodeNorm();if(t===q)return this.state=$t,void this.fail("XML declaration is incomplete.");rt(t)||(oe(t)?this.q=t:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const t=this.captureTo([this.q,q]);if(t===q)return this.state=$t,this.text="",void this.fail("XML declaration is incomplete.");if(t===L)return;const s=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const i=s;this.xmlDecl.version=i,/^1\.[0-9]+$/.test(i)?this.opt.forceXMLVersion||this.setXMLVersion(i):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(s)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=s;break;case"standalone":s!=="yes"&&s!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=s}this.name="",this.state=32}sXMLDeclSeparator(){const t=this.getCodeNorm();t!==q?(rt(t)||(this.fail("whitespace required."),this.unGet()),this.state=27):this.state=$t}sXMLDeclEnding(){this.getCodeNorm()===F?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),this.xmlDeclHandler?.(this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=tt):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){const t=this.captureNameChars();if(t===L)return;const s=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=s.ns=Object.create(null)),this.openTagStartHandler?.(s),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),t){case F:this.openTag();break;case 47:this.state=35;break;default:rt(t)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===F?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const t=this.skipSpaces();t!==L&&(Gt(t)?(this.unGet(),this.state=37):t===F?this.openTag():t===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const t=this.captureNameChars();t===Ft?this.state=39:rt(t)?this.state=38:t===F?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):t!==L&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const t=this.skipSpaces();switch(t){case L:return;case Ft:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",t===F?this.openTag():Gt(t)?(this.unGet(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const t=this.getCodeNorm();oe(t)?(this.q=t,this.state=40):rt(t)||(this.fail("unquoted attribute value."),this.state=42,this.unGet())}sAttribValueQuoted(){const{q:t,chunk:s}=this;let{i}=this;for(;;)switch(this.getCode()){case t:return this.pushAttrib(this.name,this.text+s.slice(i,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=s.slice(i,this.prevI),this.state=14,void(this.entityReturnState=40);case ft:case bt:case 9:this.text+=`${s.slice(i,this.prevI)} `,i=this.i;break;case Ot:return this.text+=s.slice(i,this.prevI),void this.fail("disallowed character.");case L:return void(this.text+=s.slice(i))}}sAttribValueClosed(){const t=this.getCodeNorm();rt(t)?this.state=36:t===F?this.openTag():t===47?this.state=35:Gt(t)?(this.fail("no whitespace between attributes."),this.unGet(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const t=this.captureTo(Ge);switch(t){case 38:this.state=14,this.entityReturnState=42;break;case Ot:this.fail("disallowed character.");break;case L:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",t===F?this.openTag():this.state=36}}sCloseTag(){const t=this.captureNameChars();t===F?this.closeTag():rt(t)?this.state=44:t!==L&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case F:this.closeTag();break;case L:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:t,forbiddenState:s}=this;const{chunk:i,textHandler:a}=this;t:for(;;)switch(this.getCode()){case Ot:if(this.state=15,a!==void 0){const{text:n}=this,c=i.slice(t,this.prevI);n.length!==0?(a(n+c),this.text=""):c.length!==0&&a(c)}s=0;break t;case 38:this.state=14,this.entityReturnState=tt,a!==void 0&&(this.text+=i.slice(t,this.prevI)),s=0;break t;case Wt:switch(s){case 0:s=1;break;case 1:s=2;break;case 2:break;default:throw new Error("impossible state")}break;case F:s===2&&this.fail('the string "]]>" is disallowed in char data.'),s=0;break;case bt:a!==void 0&&(this.text+=`${i.slice(t,this.prevI)}
`),t=this.i,s=0;break;case L:a!==void 0&&(this.text+=i.slice(t));break t;default:s=0}this.forbiddenState=s}handleTextOutsideRoot(){let{i:t}=this;const{chunk:s,textHandler:i}=this;let a=!1;t:for(;;){const n=this.getCode();switch(n){case Ot:if(this.state=15,i!==void 0){const{text:c}=this,p=s.slice(t,this.prevI);c.length!==0?(i(c+p),this.text=""):p.length!==0&&i(p)}break t;case 38:this.state=14,this.entityReturnState=tt,i!==void 0&&(this.text+=s.slice(t,this.prevI)),a=!0;break t;case bt:i!==void 0&&(this.text+=`${s.slice(t,this.prevI)}
`),t=this.i;break;case L:i!==void 0&&(this.text+=s.slice(t));break t;default:rt(n)||(a=!0)}}a&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(t,s){const{prefix:i,local:a}=this.qName(t),n={name:t,prefix:i,local:a,value:s};if(this.attribList.push(n),this.attributeHandler?.(n),i==="xmlns"){const c=s.trim();this.currentXMLVersion==="1.0"&&c===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[a]=c,le(this,a,c)}else if(t==="xmlns"){const c=s.trim();this.topNS[""]=c,le(this,"",c)}}pushAttribPlain(t,s){const i={name:t,value:s};this.attribList.push(i),this.attributeHandler?.(i)}end(){this.sawRoot||this.fail("document must contain a root element.");const{tags:t}=this;for(;t.length>0;){const i=t.pop();this.fail(`unclosed tag: ${i.name}`)}this.state!==0&&this.state!==tt&&this.fail("unexpected end.");const{text:s}=this;return s.length!==0&&(this.textHandler?.(s),this.text=""),this._closed=!0,this.endHandler?.(),this._init(),this}resolve(t){let s=this.topNS[t];if(s!==void 0)return s;const{tags:i}=this;for(let a=i.length-1;a>=0;a--)if(s=i[a].ns[t],s!==void 0)return s;return s=this.ns[t],s!==void 0?s:this.opt.resolvePrefix?.(t)}qName(t){const s=t.indexOf(":");if(s===-1)return{prefix:"",local:t};const i=t.slice(s+1),a=t.slice(0,s);return(a===""||i===""||i.includes(":"))&&this.fail(`malformed name: ${t}.`),{prefix:a,local:i}}processAttribsNS(){const{attribList:t}=this,s=this.tag;{const{prefix:n,local:c}=this.qName(s.name);s.prefix=n,s.local=c;const p=s.uri=this.resolve(n)??"";n!==""&&(n==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),p===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(n)}.`),s.uri=n))}if(t.length===0)return;const{attributes:i}=s,a=new Set;for(const n of t){const{name:c,prefix:p,local:A}=n;let x,w;p===""?(x=c==="xmlns"?Bt:"",w=c):(x=this.resolve(p),x===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(p)}.`),x=p),w=`{${x}}${A}`),a.has(w)&&this.fail(`duplicate attribute: ${w}.`),a.add(w),n.uri=x,i[c]=n}this.attribList=[]}processAttribsPlain(){const{attribList:t}=this,s=this.tag.attributes;for(const{name:i,value:a}of t)s[i]!==void 0&&this.fail(`duplicate attribute: ${i}.`),s[i]=a;this.attribList=[]}openTag(){this.processAttribs();const{tags:t}=this,s=this.tag;s.isSelfClosing=!1,this.openTagHandler?.(s),t.push(s),this.state=tt,this.name=""}openSelfClosingTag(){this.processAttribs();const{tags:t}=this,s=this.tag;s.isSelfClosing=!0,this.openTagHandler?.(s),this.closeTagHandler?.(s),(this.tag=t[t.length-1]??null)===null&&(this.closedRoot=!0),this.state=tt,this.name=""}closeTag(){const{tags:t,name:s}=this;if(this.state=tt,this.name="",s==="")return this.fail("weird empty close tag."),void(this.text+="</>");const i=this.closeTagHandler;let a=t.length;for(;a-- >0;){const n=this.tag=t.pop();if(this.topNS=n.ns,i?.(n),n.name===s)break;this.fail(`unexpected close tag: ${s}.`)}a===0?this.closedRoot=!0:a<0&&(this.fail(`unmatched closing tag: ${s}.`),this.text+=`</${s}>`)}parseEntity(t){if(t[0]!=="#"){const i=this.ENTITIES[t];return i!==void 0?i:(this.fail(this.isName(t)?"undefined entity.":"disallowed character in entity name."),`&${t};`)}let s=NaN;return t[1]==="x"&&/^#x[0-9a-f]+$/i.test(t)?s=parseInt(t.slice(2),16):/^#[0-9]+$/.test(t)&&(s=parseInt(t.slice(1),10)),this.isChar(s)?String.fromCodePoint(s):(this.fail("malformed character entity."),`&${t};`)}}var ce,At;(At=ce||(ce={})).Events={XmlDecl:"xmldecl",Text:"text",ProcessingInstruction:"processinginstruction",Doctype:"doctype",Comment:"comment",OpenTagStart:"opentagstart",Attribute:"attribute",OpenTag:"opentag",CloseTag:"closetag",CDdata:"cdata",Error:"error",End:"end",Ready:"ready"},At.parseStream=async(o,t,s)=>{const i=new Ze({position:!1,...s});let a;if(t.onOpenTagStart&&i.on(At.Events.OpenTagStart,t.onOpenTagStart),t.onOpenTag&&i.on(At.Events.OpenTag,t.onOpenTag),t.onCloseTag&&i.on(At.Events.CloseTag,t.onCloseTag),t.onAttribute&&i.on(At.Events.Attribute,t.onAttribute),t.onText&&i.on(At.Events.Text,t.onText),t.onError&&i.on(At.Events.Error,t.onError),t.onEnd){t.onEnd;const n=()=>{a=t.onEnd()};i.on(At.Events.End,n)}for(;;){const{value:n,done:c}=await o.read();if(c)break;i.write(n)}return i.close(),a};const E=o=>o===!0||o==="1"||o==="on"||o==="true"||o!==!1&&o!=="0"&&o!=="off"&&o!=="false"&&null,V=o=>{const t=parseInt(o);return isNaN(t)?null:t},yt=o=>{const t=parseFloat(o);return isNaN(t)?null:t},I=null;class Ke{constructor(){this._registeredVisitors=new Map}registerVisitor(t){this._registeredVisitors.set(t.from,t)}createEventHandler(t,s,i){const a=this._registeredVisitors,n=[];let c=null,p=null,A=null,x=null;const w=[],v={key:null,source:t};let y=null,P=!1;const N=(l,d)=>{let m=A.attributes[l];if(d){if(Array.isArray(d)){for(let _=0;_<d.length;_++)if(m==null||(m=d[_](m),m==null))return}else if(m==null||(m=d(m),m==null))return}return m},D={getSource:()=>y.source,setSource:l=>{y.source=l},setKey:l=>{y.key=l},getFrom:()=>A,getAttribute:(l,d)=>N(l,d)??null,hasAttribute:l=>D.getAttribute(l)!==null,getParent:()=>w[w.length-2].source,getPath:()=>{const l=[];for(let d=0;d<n.length;d++)l.push(n[d].local);return l.join("\\")},parseAttribute:N,copyToObject:(l,d,m,_)=>{const z=N(_??d,m);z!==void 0&&(l[d]=z)},copyTo:(l,d,m)=>{const _=N(m??l,d);_!==void 0&&(y.source[l]=_)},warn:l=>{i?i?.(l):console.warn(l)}};return{onOpenTag:l=>{let d=l.name;const m=d.indexOf(":");m!==-1&&(d=d.slice(m+1));const _=a.get(d);if(c={local:d,visitor:_,tag:l,destination:null},P)return n.push(c),p=d,void(A=l);x=c?.visitor??null,_&&(y=n.length===0?v:x?.to!==null?{key:null,source:{}}:null,c.destination=y,y&&w.push(y)),n.push(c),p=d,A=l,P=x?.to===null,x?.openTag?.(D)},onCloseTag:l=>{let d=l.name;const m=d.indexOf(":");if(m!==-1&&(d=d.slice(m+1)),d!==p)throw new Error(`mismatch open/close tag: '${d}'/'${p}'`);P||x?.closeTag?.(D);const _=n.pop()??null;c=n[n.length-1]??null;const z=_?.destination;if(z){w.pop(),y=w[w.length-1]??v;const at=_.visitor;at&&at.to&&z.source!==void 0&&(Array.isArray(at.to)?y.source.push?y.source.push(z.source):i?.(`Unable to parse array for ${at.from} at ${D.getPath()}`):z.key?y.source[z.key]=z.source:typeof at.to=="string"&&(y.source[at.to]=z.source))}p=c?.local??null,A=c?.tag??null,x=c?.visitor??null,P=!c?.destination},onText:l=>{x?.text?.(l,D)},onEnd:s}}}const me=(o,t,s,i=null)=>{if(!o)return null;let a=o;a.startsWith("/")&&(a=a.substring(1));let n=i?.parsedRefs?.get(o);if(n!==void 0)return n;const c=t(a);if(!c)return null;let p=c.content;try{s&&(p=s(p))}catch(A){console.warn(A)}return i?.parsedRefs?.set(o,p),p},he=(o,t,s,i,a=null)=>{if(!o)return null;let n=o;n.startsWith("/")&&(n=n.substring(1));let c=a?.parsedRefs?.get(o);if(c!==void 0)return c;const p=t(n);if(!p)return null;const A=p.content;try{const x=new TextDecoder().decode(A),w=s.parseFromString(x,"text/xml"),v=i.convert(w,o,a);return a?.parsedRefs?.set(o,v),v}catch(x){console.warn(x)}return null},Xt=(o,t,s,i,a=null)=>{const n=new Map;let c=t.Directory[o];const p=c?c.length:0;for(let A=0;A<p;A++){const x=c[A];if(!x)continue;let w=x;w.startsWith("/")&&(w=w.substring(1));const v=he(w,y=>t.files[y],s,i,a);n.set(w,v)}return n},Ye=async(o,t=8388608)=>{await(async()=>{if(typeof ReadableStream>"u")if(typeof window>"u"){const{ReadableStream:n}=await Qt(async()=>{const{ReadableStream:c}=await import("./Db3OxT_JhcQQiyAU-lthz0QMv.js");return{ReadableStream:c}},[],import.meta.url);globalThis.ReadableStream=n}else console.warn("Browser does not support ReadableStream; consider loading a polyfill.")})();const s=new TextDecoder("utf-8");let i=0;const a=o instanceof Uint8Array?o:new Uint8Array(o);return new ReadableStream({pull(n){if(i>=a.byteLength)return void n.close();const c=a.subarray(i,Math.min(i+t,a.byteLength)),p=s.decode(c,{stream:i+t<a.byteLength});n.enqueue(p),i+=c.length}}).getReader()},ts=["lt1","dk1","lt2","dk2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"],Te=(o,t="dk1")=>{let s;const i=o("auto");i===void 0||i!=="1"&&i!=="true"||(s=t);const a=o("indexed");a&&(s=`index${a}`);const n=o("rgb");n&&(s=n.toLowerCase(),n.length!==8||n.startsWith("FF")||(s="FF"+n.substring(2,n.length)));const c=o("theme");c&&(s=ts[c]);let p=o("tint");if(p&&(s+=` ${Ee.AdjustmentType.ETint} ${parseFloat(p)}`),s)return s},es=o=>o&&o.replace(/^\{([\s\S]+)\}$/,"$1"),ps=o=>o?re.roundAccurately(parseFloat(o)/12700,4):null,gs=o=>o?re.roundAccurately(parseFloat(o)/9525,1):null,fs=o=>parseFloat(o)/1e3,ms=o=>parseFloat(o)/6e4,ss=o=>o==="true"||o==="1",nt=class nt{};nt.Collapsed=1,nt.CustomFormat=2,nt.CustomHeight=4,nt.Hidden=8,nt.Ht=16,nt.OutlineLevel=32,nt.Ph=64,nt.R=128,nt.S=256,nt.Spans=512,nt.ThickBot=1024,nt.ThickTop=2048;let Dt=nt;const os=(o,t,s)=>{if(o[0].value[0]===o[1].value[0])return t},be={colStart:0,colEnd:0,rowStart:0,rowEnd:0},is=(o,t,s,i,a,n,c)=>{let p=!1,A=!1,x=[],w=!1,v=null,y=null,P=null,N=null,D=null,l=null;const d=c?.get("richData")??[],m=xt.normalizeA1ToR1C1,_=ae.createConflatingRanges(),z=new Map,at=[];let Et=null;const Mt=ae.createConflatingRanges();let It,mt=!1,H=-1,U=-1,et=null,st=null;const Pt=[];let Vt=null,Jt=-2,ht=0,wt="",vt="",ut="",Tt="",St="",J="",dt="",qt="",Zt="",Lt="",Kt="",jt="",Yt="",te="",T=!0,R=null,G=!1,Z=!1,K=null,O=0;return{...s,onEnd:()=>{Pt.length>0&&(t.rows=Pt);let g=_.done(os);const C=g.length;if(C>0){const b=new Array(C);for(let k=0;k<C;k++){const B=g[k],Q=xt.rangeToString(B),ot=B.value[1],lt=xt.resolveRelativeToA1(ot,B.rowStart,B.colStart);b[k]=[Q,lt]}t.formulas=b}const Y=Mt.done(!0),S=Y.length;if(S>0){const b=new Array(S);for(let k=0;k<S;k++){const B=Y[k],Q=xt.rangeToString(B);b[k]=Q}t.volatile=b}if(at.length>0&&(t.dynamicArray=[...at]),x.length>0){x.sort(ae.createRangeComparator(Ie.Orientation.Column));const b=[];let k=null,B=-1,Q=-1,ot=-1,lt=-1,pt=null;const M=x.length;M>0&&(k=x[0],B=k.colStart,Q=k.colEnd,ot=k.rowEnd,lt=k.value,b.push(k));for(let gt=1;gt<M;gt++)pt=x[gt],lt!==pt.value||B!==pt.colStart||Q!==pt.colEnd||ot+1!==pt.rowEnd?(b.push(pt),k=pt,B=k.colStart,Q=k.colEnd,ot=k.rowEnd,lt=k.value):(ot=pt.rowEnd,k.rowEnd=ot);let W=[];for(let gt=0;gt<b.length;gt++){const it=b[gt];W.push({r:{colStart:it.colStart,colEnd:it.colEnd,rowStart:it.rowStart,rowEnd:it.rowEnd},v:it.value})}t.directStyles=W}const $=o.build();if($){const b=$.tuples;t.data=b}s?.onEnd?.()},onOpenTag:g=>{let C=g.name;const Y=C.indexOf(":");if(Y!==-1&&(C=C.slice(Y+1)),O++,O%196608==0&&a(O),It){const S=g.attributes;switch(C){case"v":A=!0;break;case"f":switch(S.t??null){case null:case"normal":w=!0;break;case"shared":const $=S.si;y=S.ref,v=$;break;case"array":w=!0,y=S.ref,Et=[y,!1];break;case"datatable":w=!0,y=S.ref,w=!0}S.ca!==void 0&&Mt.append(H,U);break;case"is":return void(mt=!0)}return void(mt&&n?.onOpenTag(g))}if(p){if(C==="c"){It=g;const S=g.attributes.r;U=xt.fastStringToCol(S);const $=g.attributes.t;$===void 0?st=null:(st=$,st==="str"&&(mt=!0));let b=g.attributes.s;b===void 0&&(K!==null||Z)&&(b="0"),b!==void 0&&(b=parseInt(b),R&&R.value===b&&R.colEnd+1===U?R.colEnd=U:(R={colStart:U,rowStart:H,colEnd:U,rowEnd:H,value:b},x.push(R)))}}else{if(C==="row"){p=!0;const S=g.attributes.r;if(H=parseInt(S)-1,ht=0,vt=g.attributes.customHeight,vt!==void 0&&(ht|=Dt.CustomHeight),vt!==Zt&&(T=!0,Zt=vt),wt=g.attributes.ht,wt!==void 0&&(ht|=Dt.Ht),wt!==qt&&(T=!0,qt=wt),ut=g.attributes.hidden,ut!==void 0&&(ht|=Dt.Hidden),ut!==Lt&&(T=!0,Lt=ut),St=g.attributes.s,St!==void 0&&(ht|=Dt.S),St!==jt&&(T=!0,jt=St),Tt=g.attributes.customFormat,Tt!==void 0&&(ht|=Dt.CustomFormat),Tt!==Kt&&(T=!0,Kt=Tt),J=g.attributes.outlineLevel,J!==void 0&&(ht|=Dt.OutlineLevel),J!==Yt&&(T=!0,Yt=J),dt=g.attributes.collapsed,dt!==void 0&&(ht|=Dt.Collapsed),dt!==te&&(T=!0,te=dt),ht!==0)if(Jt+1!==H||T){const $=vt!==void 0&&(vt==="1"||vt==="true");K=Tt!==void 0&&(Tt==="1"||Tt==="true")&&St!==void 0?St:null,Vt={min:H,max:H,sz:wt===void 0?-1:parseFloat(wt),csz:$,h:ut!==void 0&&(ut==="1"||ut==="true"),s:K===null?void 0:K==="0"?0:parseInt(K),l:J===void 0||J==="0"?0:parseInt(J),cl:dt!==void 0&&(dt==="1"||dt==="true")},Pt.push(Vt)}else Vt.max=H;return Jt=H,void(T=!1)}if(!G&&C==="sheetData"){G=!0;const S=t.cols,$=S?S.length:0;for(let b=0;!Z&&b<$;b++)S[b].s&&(Z=!0)}s?.onOpenTag(g)}},onCloseTag:g=>{if(It){let C=g.name;const Y=C.indexOf(":");if(Y!==-1&&(C=C.slice(Y+1)),mt)if(C==="is"||C==="v"){const S=n?.onEnd();S!==null&&o.addValue(H,U,""+S)}else n?.onCloseTag?.(g);return A&&(A=!1),void(C==="c"&&(It=null,mt=!1))}if(p)return p=!1,void(R=null);s?.onCloseTag(g)},onText:g=>{if(g=g.trim(),A){switch(et=null,st){case null:case"n":et=parseFloat(g);break;case"b":et=g==="1"||g==="true";break;case"s":et=g;break;case"e":if(g==="#VALUE!"){const Y=It.attributes.vm;if(Y!==void 0){const S=d[parseInt(Y)-1];if(S&&S.isFormulaError){et={t:_t.Error,v:S.getCode()};break}}}const C=Pe.getBuiltInByLabel(g);C?et={t:_t.Error,v:C.getCode()}:(et=g,i?.(`Unknown formula error '${g}' in cell ${xt.cellToString({colIndex:U,rowIndex:H})}`));break;case"str":case"inlineStr":mt=!0}et!==null&&o.addValue(H,U,et)}if(Et&&(st==="e"&&(Et[1]=!0),at.push(Et),Et=null),v)if(D===v)N=l;else{if(N=z.get(v),!N){const C=[];P=m(g,H,U,C),N=[P,C,g],z.set(v,N)}D=v,l=N}if(w){const C=[];P=m(g,H,U,C),N=[P,C,g]}if(N)return _.append(H,U,N),N=null,w=!1,v=null,void(y=null);mt?n?.onText(g):p||s?.onText(g)}}},Ts=Object.freeze(Object.defineProperty({__proto__:null,readBufferXLSX:async(o,t)=>{const{password:s,createWorkbookOptions:i={},...a}=t??{},n=[],c=t?.progress,p=c?.onProgress;let A=0;const x=Qt(()=>import("./BnAW7Y6iGMyaZGOX-ZTlTDMFw.js"),[],import.meta.url),w=Qt(()=>import("./BDKNXcPPkYQKShJT-B2hUIgn8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url);let v=null;try{v=new DOMParser}catch{}let y=null;v||(y=Qt(()=>import("./2LDjDMGuxZSZ765A-D1vKg2PG.js"),[],import.meta.url).then(l=>l.i));let P=null,N=null,D=null;try{const l=await Promise.all([x,w,y]);P=l[0],N=l[1],D=l[2]}catch(l){throw new Error("Unable to load XLSX parser.",{cause:l})}try{const l=P.read(o,{type:"array",sheets:[],cellStyles:!1,bookFiles:!0});if(!l.Directory)throw new Oe("Unable to parse as an Excel document. Try to save as '.xlsx' and try again.");l.Directory.richstructure=["/xl/richData/rdrichvaluestructure.xml"],l.Directory.richdata=["/xl/richData/rdrichvalue.xml"];const d=new N.FromOOXMLConverter,m=v??new D.DOMParser,_=i?.resources??new Ce,z=_.beginPersist(),at={},Et=new Set,Mt=new Map;Mt.set("richTypes",[]);const It=new Map,mt=[],H=T=>l.files[T],U=(T,R)=>{const G=T.lastIndexOf("/"),Z=T.substring(0,G+1)+"_rels/"+T.substring(G+1,T.length)+".rels";let K=R.get(Z);return K||(K=((O,g,C,Y,S=null)=>{if(!O)return null;const $=he(O,g,C,Y,S);if(!$)return null;const b=new Map,k=Object.keys($),B=k.length;for(let Q=0;Q<B;Q++){const ot=k[Q],lt=$[ot];b.set(ot,lt)}return b})(Z,H,m,d,st),R.set(Z,K)),K},et=(T,R,G,Z=It)=>{let K=U(R,Z).get(T),O=K?.target;if(!O)return null;if(K.targetMode==="External")return K.target;const g=R.lastIndexOf("/"),C=R.substring(0,g+1);O.startsWith("/")||(O=C+O),O=($=>{const b=$.split(/\/+/);return b.reduce((k,B,Q)=>(B==="."?k.splice(Q,1):B===".."&&k.splice(Q-1,2),k),b).join("/")})(O);const Y=d?.getVisitorParamsState().get("dxfs");let S=Z.get(O);if(!S)if(K.type==="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"){const $={};S=$;const b=async()=>{const k=((M,W,gt,it,Ct,kt,ne,zt)=>{const u=new Ke,ct=new ke.TransposedBuilder;let X=null;u.registerVisitor({from:"autoFilter",to:"filter",openTag:e=>{e.copyTo("ref",I)}}),u.registerVisitor({from:"conditionalFormatting",to:{},openTag:e=>{const r=e.getParent();r.conditionals||(r.conditionals=[]),r.conditionals.push(e.getSource());const h=e.getAttribute("sqref");h&&(e.getSource().ref=h.split(" ").join(",")),e.copyTo("pivot",E)},closeTag:e=>{const r=e.getSource();if(r.rule){const h=Object.keys(r.rule);for(let f=0;f<h.length;f++){const j=h[f];j!=="rule"&&(r[j]=r.rule[j])}}delete r.rule}}),u.registerVisitor({from:"cfRule",to:"rule",openTag:e=>{const r=e.getParent();e.copyToObject(r,"type",I),e.copyToObject(r,"priority",V),e.copyToObject(r,"stopIfTrue",E);const h=e.getAttribute("dxfId",V);if(h!==null){let f=it?.get(h);f||(kt?.(`Unable to load conditional color. Invalid dxfI: '${h}' at '${e.getPath()}'.`),f={}),r.style=f}e.copyToObject(r,"aboveAverage",E),e.copyToObject(r,"equalAverage",E),e.copyToObject(r,"stdDev",V),e.copyToObject(r,"bottom",E),e.copyToObject(r,"percent",E),e.copyToObject(r,"rank",V),e.copyToObject(r,"operator",I),e.copyToObject(r,"text",I),e.copyToObject(r,"timePeriod",I)}}),u.registerVisitor({from:"colorScale",to:"colorScale"}),u.registerVisitor({from:"dataBar",to:"dataBar",openTag:e=>{e.copyTo("maxLength",V),e.copyTo("minLength",V),e.copyTo("showValue",E)}}),u.registerVisitor({from:"iconSet",to:"iconSet",openTag:e=>{e.copyTo("iconSet",I),e.copyTo("reverse",E),e.copyTo("showValue",E)}}),u.registerVisitor({from:"formula",to:null,text:(e,r)=>{const h=r.getParent();let f=h.formulas;f||(f=[],h.formulas=f),f.push(e)}}),u.registerVisitor({from:"cfvo",to:{},openTag:e=>{const r=e.getParent();r.conditions||(r.conditions=[]),r.conditions.push(e.getSource()),e.copyTo("type",I),e.copyTo("value",yt,"val"),e.copyTo("gte",E)}}),u.registerVisitor({from:"color",to:{},openTag:e=>{const r=e.getParent();r.colors||(r.colors=[]);const h=Te(f=>e.getAttribute(f));r.colors.push(h)}}),u.registerVisitor({from:"filterColumn",to:"filterColumn",openTag:e=>{const r=e.getParent();r.fields||(r.fields=[]),r.fields.push(e.getSource()),e.copyTo("offset",V,"colId"),e.copyTo("hiddenButton",E),e.copyTo("showButton",E)}}),u.registerVisitor({from:"colorFilter",to:"colorFilter",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Ht.Type.Color,e.copyTo("cellColor",E),e.copyTo("styleId",V,"dxfId")}}),u.registerVisitor({from:"dynamicFilter",to:"dynamicFilter",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Ht.Type.Dynamic,e.copyTo("dynamicType",I,"type"),e.copyTo("val",yt),e.copyTo("maxVal",yt,"maxVal")}}),u.registerVisitor({from:"iconFilter",to:"iconFilter",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Ht.Type.Icon,e.copyTo("iconId",V),e.copyTo("iconSet",I)}}),u.registerVisitor({from:"top10",to:"top10",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Ht.Type.Top10,e.copyTo("filterVal",yt),e.copyTo("percent",E),e.copyTo("top",E),e.copyTo("val",yt)}}),u.registerVisitor({from:"filters",to:"filters",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Ht.Type.Items,e.copyTo("blank",E),e.copyTo("calendarType",I)}}),u.registerVisitor({from:"dateGroupItem",to:"dateGroupItem",openTag:e=>{const r=e.getParent();r.dateGroups||(r.dateGroups=[]),r.dateGroups.push(e.getSource()),e.copyTo("group",I,"dateTimeGrouping"),e.copyTo("day",V),e.copyTo("hour",V),e.copyTo("minute",V),e.copyTo("month",V),e.copyTo("second",V),e.copyTo("year",V)}}),u.registerVisitor({from:"filter",to:"filter",openTag:e=>{const r=e.getParent();r.items||(r.items=[]),r.items.push(e.getAttribute("val",yt))}}),u.registerVisitor({from:"customFilters",to:"customFilters",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Ht.Type.Custom,e.copyTo("and",E)}}),u.registerVisitor({from:"customFilter",to:"customFilter",openTag:e=>{const r=e.getParent();r.filters||(r.filters=[]),r.filters.push(e.getSource()),e.copyTo("operator",I),e.copyTo("value",yt,"val")}}),u.registerVisitor({from:"sortState",to:"sort",openTag:e=>{e.copyTo("ref",I)}}),u.registerVisitor({from:"sortCondition",to:"sortCondition",openTag:e=>{const r=e.getParent();r.fields||(r.fields=[]);const h=e.getSource();r.fields.push(h),e.copyTo("sortOn",I,"sortBy"),e.copyTo("dxfId",I,"sortBy"),e.copyTo("iconSet",I),e.copyTo("customList",I);const f=e.getAttribute("ref");if(f){const j=xt.fastStringToRange(f,be).colStart,Nt=xt.fastStringToRange(r.ref,be),se=Nt.colStart;h.offset=Nt?j-se:j}h.reverse=e.getAttribute("descending",E)??!1}}),u.registerVisitor({from:"AlternateContent",to:null});const ee=e=>{X=e.getSource(),e.copyTo("topLeft",I,"topLeftCell");const r=ss(e.getAttribute("defaultGridColor")),h=e.getAttribute("colorId");h===null||r||(e.getSource().gridLineColor="index"+parseFloat(h)),e.copyTo("showZeros",E),e.copyTo("showFormulas",E),e.copyTo("zoomScale",V),e.copyTo("showRowHeaders",E,"showRowColHeaders"),e.copyTo("showColumnHeaders",E,"showRowColHeaders"),e.copyTo("showRowGridlines",E,"showGridLines"),e.copyTo("showColumnGridlines",E,"showGridLines")};u.registerVisitor({from:"sheetView",to:"view",openTag:e=>{ee(e)},closeTag:()=>{X=null}}),u.registerVisitor({from:"customSheetViews",to:"customSheetViews",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"customSheetView",to:[],openTag:e=>{ee(e)},closeTag:()=>{X=null}}),u.registerVisitor({from:"selection",to:"selection",openTag:e=>{if(!X)return;e.copyTo("cell",I,"activeCell"),e.copyTo("rangeIndex",V,"activeCellId");const r=e.getAttribute("activeCell"),h=e.getAttribute("sqref");h&&h!==r&&(e.getSource().ranges=h.split(" "))}}),u.registerVisitor({from:"pane",to:"pane",openTag:e=>{if(X&&e.getAttribute("state")==="frozen"){const r={};X.freezePanes=r,e.copyToObject(r,"topLeft",I,"topLeftCell");const h=X.topLeft?xt.fastStringToCell(X.topLeft):{colIndex:0,rowIndex:0},f={colIndex:0,rowIndex:0};e.copyToObject(f,"colIndex",V,"xSplit"),e.copyToObject(f,"rowIndex",V,"ySplit");const j={colIndex:h.colIndex+f.colIndex,rowIndex:h.rowIndex+f.rowIndex};r.coords=xt.cellToString(j)}}}),u.registerVisitor({from:"tabColor",to:null,openTag:e=>{const r=Te(h=>e.getAttribute(h));r&&(M.tabColor=r)}}),u.registerVisitor({from:"pageSetUpPr",to:"pageSetUpPr",openTag:e=>{}}),u.registerVisitor({from:"outlinePr",to:"outlinePr",openTag:e=>{}}),u.registerVisitor({from:"pageMargins",to:"pageMargins",openTag:e=>{}}),u.registerVisitor({from:"pageSetup",to:"pageSetup",openTag:e=>{}}),u.registerVisitor({from:"printOptions",to:"printOptions",openTag:e=>{}}),u.registerVisitor({from:"mergeCells",to:"merges",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"mergeCell",to:[],openTag:e=>{const r=e.getAttribute("ref");e.setSource(r)}}),u.registerVisitor({from:"hyperlinks",to:"hyperlinks",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"hyperlink",to:[],openTag:e=>{const r=e.getAttribute("r:id"),h=e.getAttribute("ref");if(!h)return void console.warn("No ref found for hyperlink");e.setKey(h);let f=r?W(r):"";if(typeof f!="string")return void console.warn("Invalid address ",f);const j=e.getAttribute("location");f.endsWith("\\")&&(f=f.substring(0,f.length-1));const Nt=e.getAttribute("location");if(Nt&&(j&&j!==Nt&&console.warn("display and location are different",j,Nt),f+="#"+Nt),!f)return void console.warn("No address found for hyperlink. r:id",r);let se;const ue=e.getAttribute("tooltip");se=ue?{address:f,tooltip:ue}:f,e.setSource({r:h,v:se})}}),u.registerVisitor({from:"drawing",to:"movables",openTag:e=>{const r=e.getAttribute("r:id");if(!r)return;const h=W(r);h?e.setSource(h.movables):console.warn("no drawing found for rId",r)}}),u.registerVisitor({from:"tableParts",to:"tables",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"tablePart",to:[],openTag:e=>{const r=e.getAttribute("r:id");if(!r)return;const h=W(r);h?e.setSource(h):console.warn("no table found for rId",r)}}),u.registerVisitor({from:"worksheet",to:"worksheet",openTag:e=>{}}),u.registerVisitor({from:"sheetProtection",to:"protection",openTag:e=>{let r=!1;if(e.hasAttribute("sheet")&&E(e.getAttribute("sheet"))&&(r=!0),!r)return void e.setSource(void 0);const h=j=>j===!0||j==="1"||j==="on"||j==="true"||j===!1||j==="0"||j==="off"||j==="false"||null;e.copyTo("autoFilter",h),e.copyTo("deleteColumns",h),e.copyTo("formatCells",h),e.copyTo("formatColumns",h),e.copyTo("formatRows",h),e.copyTo("insertColumns",h),e.copyTo("insertHyperlinks",h),e.copyTo("insertRows",h),e.copyTo("objects",h),e.copyTo("pivotTables",h),e.copyTo("scenarios",h),e.copyTo("selectUnlockedCells",h),e.copyTo("selectUnlockedCells",h),e.copyTo("sort",h);const f={};e.copyToObject(f,"hash",I,"hashValue"),e.copyToObject(f,"algorithm",I,"algorithmName"),e.copyToObject(f,"salt",I,"saltValue"),e.copyToObject(f,"spinCount",V),Object.keys(f).length>0&&(e.getSource().password=f)}}),u.registerVisitor({from:"protectedRanges",to:"protectedRanges",openTag:e=>{e.setSource({})}}),u.registerVisitor({from:"protectedRange",to:{},openTag:e=>{const r=e.getAttribute("sqref");e.setKey(r),e.copyTo("name"),e.copyTo("securityDescriptor");const h={};e.copyToObject(h,"hash",I,"hashValue"),e.copyToObject(h,"algorithm",I,"algorithmName"),e.copyToObject(h,"salt",I,"saltValue"),e.copyToObject(h,"spinCount",V),Object.keys(h).length>0&&(e.getSource().password=h)}}),u.registerVisitor({from:"sheetFormatPr",to:"sheetFormatPr",openTag:e=>{e.copyToObject(M,"defaultColSize",yt,"defaultColWidth"),e.copyToObject(M,"outlineLevelCol",V,"outlineLevelCol");const r=e.getAttribute("customHeight");r!=="1"&&r!=="true"||e.copyToObject(M,"defaultRowSize",yt,"defaultRowHeight"),e.copyToObject(M,"outlineLevelRow",V,"outlineLevelRow")}}),u.registerVisitor({from:"cols",to:"cols",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"col",to:[],openTag:e=>{e.copyTo("min",r=>parseInt(r)-1),e.copyTo("max",r=>parseInt(r)-1),e.copyTo("sz",yt,"width"),e.copyTo("csz",E,"customWidth"),e.copyTo("h",E,"hidden"),e.copyTo("l",V,"outlineLevel"),e.copyTo("s",V,"style")}}),u.registerVisitor({from:"oleObjects",to:null,openTag:e=>{e.warn("'OLE Objects' are not supported.")}});let Ut=null;const Se={onOpenTag:e=>{Ut===null&&(Ut="")},onText:e=>{Ut+=e},onEnd:()=>{const e=gt(Ut);return Ut=null,e},onError:e=>{}};return is(ct,M,u.createEventHandler(M,Ct,kt),kt,ne,Se,zt)})($,(M,W=!1)=>et(M,O,W)??null,vt,Y,()=>{},(M,W)=>{W=W?`${W} (${O})`:O,n.push([M,W])},M=>{A+=M,p?.(A)},Mt),B=me(O,H),Q=await Ye(B);try{await ce.parseStream(Q,k,{xmlns:!1})}catch(M){throw console.warn(`Error parsing sheet: '${O}'`,M),new Error(`Error parsing sheet: '${O}'`,{cause:M})}const ot=U(O,Z);let lt,pt=new Map;if(ot){const M="http://schemas.microsoft.com/office/2017/10/relationships/threadedComment";let W;ot.forEach((it,Ct)=>{it.type===M&&(lt=et(Ct,O,!1,Z)?.comments,lt&&lt.forEach(kt=>{pt.set(kt.id,kt)}))});const gt="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";if(ot.forEach((it,Ct)=>{it.type===gt&&(W=et(Ct,O,!1,Z))}),W||lt){const it=lt??[],Ct=W?.comments;if(Ct){const kt=W?.authors,ne=Ct.length;for(let zt=0;zt<ne;zt++){const u=Ct[zt];if(!u)continue;let ct=kt&&u.authorId!==void 0?kt[u.authorId]:u.authorId;if(ct&&ct.startsWith("tc=")&&(ct=es(ct.substring(3)),pt.has(ct)))continue;let X=null;ct&&(X=ut.get(ct)),X||(X=Tt.get(ct)),X||(X={id:re.uuidV4(),displayName:ct},Tt.set(X.displayName,X),ut.set(X.id,X)),ct=X?.id??null;const ee={id:re.uuidV4(),personId:ct,ref:u.ref,done:!1,asNote:!0,content:u.content};it.push(ee)}}$.comments=it}}};mt.push(b())}else S=G?me(O,H,$=>{const b=_.add({buffer:$});return b.addReference(at),Et.add(b),z.toResourceId(b)},st):he(O,H,m,d,st);return S},st={paramMap:Mt,getRefs:U,getRef:et,parsedRefs:It,addPerson:T=>null},Pt=[];let Vt=0;l.Strings&&(Vt=parseInt(l.Strings.Unique??l.Strings.length??0));const Jt=l.Strings??[];for(let T=0;T<Vt;T++)Pt.push(Jt[T]?.t??"");const ht=new Map;let wt=Vt;const vt=T=>{const R=ht.get(T);if(R!==void 0)return R;const G=wt;return ht.set(T,wt++),Pt.push(T),G},ut=(Xt("richstructure",l,m,d,st),Xt("richdata",l,m,d,st),new Map),Tt=new Map,St=Xt("people",l,m,d);let J=null;if(St.size>0&&(J=St.entries().next()?.value?.[1]?.persons,J)){const T=J.length;for(let R=0;R<T;R++){const G=J[R];ut.set(G.id,G),ut.set(G.displayName,G)}}const dt=Xt("themes",l,m,d,st);let qt=null;if(dt&&dt.entries){let T=dt.entries().next();T?.value?.[1]&&(qt=T.value[1])}const Zt=new Ae(qt);let Lt=Xt("styles",l,m,d,st).entries().next()?.value[1];Lt&&(Lt=JSON.parse(Ve(Lt)));const Kt=Xt("workbooks",l,m,d,st);await Promise.all(mt);const jt={...Kt.entries().next().value[1],styles:Lt,theme:Zt.toJSON()};Pt.length>0&&(jt.strings=Pt),J&&J.length>0&&(jt.people=J);const Yt={...i,resources:_,json:jt},te=new De(Yt);if(Et.forEach(T=>{T.deleteReference(at)}),z.endPersist(),n.length){const T=c?.onWarning;if(T)for(const R of n){const[G,Z]=R;T(G,Z)}}return te}catch(l){let d="Unable to parse XLSX.";throw l instanceof Le&&(d="Unable to open XLSX. There are too many rows or columns."),new Error(d,{cause:l})}},writeBufferXLSX:async(o,t)=>{const s=await Qt(()=>import("./BnAW7Y6iGMyaZGOX-ZTlTDMFw.js"),[],import.meta.url),i=await o.toJSON(!0),a=s.utils.book_new();for(let n=0;n<i.sheets.length;n++){const c=i.sheets[n],p=s.utils.json_to_sheet([{}]);s.utils.book_append_sheet(a,p,c.name);const A=c.sheet,x=o.getSheetAt(n),w=x.getUsedRange();if(w?(p["!ref"]=w.getA1(),w.forEach((v,y)=>{const P={t:"z"},N=y.getCell().getStyle();if(!N.isNormal()){let D=N.getNumberFormat();D!==Rt.Type.General&&(D===Rt.Type.ShortDate?D="m/d/yyyy":D===Rt.Type.MediumDate?D="d-mmm-yy":D===Rt.Type.LongDate?D="[$-x-sysdate]dddd, mmmm dd, yyyy":D===Rt.Type.ShortTime?D="h:mm":D===Rt.Type.MediumTime?D="h:mm AM/PM":D===Rt.Type.LongTime&&(D="h:mm:ss AM/PM"),P.z=D)}if(v!==null)switch(y.getType()){case _t.Number:P.t="n",P.v=v;break;case _t.String:P.t="s",P.v=v;break;case _t.Boolean:P.t="b",P.v=v;break;case _t.Error:P.t="e",P.v=v.toString();case _t.RichData:}p[y.getA1()]=P})):p["!ref"]="A1:A1",A.merges?.length>0){const v=[];p["!merges"]=v;for(let y=0;y<A.merges.length;y++)v.push(s.utils.decode_range(A.merges[y]))}if(A.cols?.length>0){const v=[];p["!cols"]=v;const y=A.cols,P={width:A.defaultColSize??x.getColumnWidthAsFontUnit(x.getColumnHeaders().getDefaultSize())},N=y.length;for(let D=0;D<N;D++){const l=y[D];for(let m=v.length;m<=l.min-1;m++)v.push(P);const d={};l.sz!==void 0&&(d.width=l.sz),l.h!==void 0&&(d.hidden=l.h),l.l!==void 0&&(d.level=l.l);for(let m=l.min;m<=l.max;m++)v.push(d)}}}return s.write(a,{type:"array",bookType:"xlsx"}),s.write(a,{type:"array",bookType:"xlsx"})}},Symbol.toStringTag,{value:"Module"}));export{Ts as H,fs as a,ss as b,gs as c,Te as d,ms as p,es as r,ps as t};
