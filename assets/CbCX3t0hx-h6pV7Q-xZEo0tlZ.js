import{j as i}from"./index-BiBgeh3u.js";import{r as o}from"./iframe-mGP4b_Fh.js";import{k as u}from"./index-CvKDCtrJ.js";import{O as D,f as F,L as b}from"./BgsyX5QL9OLy0DN3-CLQ3UbdE.js";import{B as E}from"./index-CdE0ylvR.js";import"./index-DTwpo8e8.js";import"./preload-helper-PPVm8Dsz.js";import"./client-BMu68Vok.js";import"./index-CmvF348R.js";import"./index-CXJVXQGg.js";import"./Tooltip-CXxmTuYg.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const L=["Ok","Cancel"],U=o.memo(V=>{const{initialValue:t=null,context:a,onOption:m,onValidateOption:S,onDone:d,onInput:c,options:g=L,defaultOption:x=g?.[0],cancelOption:f="Cancel",sx:h,...C}=V,N=o.useMemo(()=>a?.().getNames().findValidName("Range1"),[]),y=o.useMemo(()=>{if(!t)return!0},[]),[n,R]=o.useState({displayText:t?.getName()??N,errorText:null}),[s,v]=o.useState({displayValue:t?.getRanges()??a?.().selection()??null,errorText:null}),[T,O]=o.useState(!1),j=o.useCallback(async e=>!n.errorText&&!s.errorText,[]),I=u((e,l,p)=>{if(!l){let r=null;y?r=a?.().getNames().addReference(n?.displayText,s?.displayValue,!1):(t.getType()==="reference"&&t.doBatch(()=>{t.setName(n?.displayText),t.setReference(s?.displayValue)},`Edit Named '${n?.displayText}'`),r=t),r&&(r.select(),c(r))}m?.(e,l,p),d?.()},[a,n,s,d,m,x,f,c]),k=u(e=>{let l=null;try{a?.().getNames().validateName(e)}catch(p){l=p.message}R({displayText:e,errorText:l})},[]),w=u(e=>{t&&t.getName().toLowerCase()===e.toLowerCase()||a?.().getNames().validateName(e)},[a,t]),B=o.useCallback(e=>{v({displayValue:e??null,errorText:null})},[]);return i.jsx(D,{title:(y?"Define":"Edit")+" Range",options:g,onOption:I,onValidateOption:j,defaultOption:x,cancelOption:f,autoFocusSel:".autoFocus",sx:{width:"460px",...h},...C,children:i.jsxs(E,{sx:{paddingTop:e=>e.spacing(1),paddingBottom:e=>e.spacing(0),rowGap:e=>e.spacing(1),range:"flex",flexDirection:"column"},children:[i.jsx(F,{formName:"name",defaultInput:N,value:n.displayText,onChangeInput:k,onValidate:w,onFocus:e=>{T||e.target?.select(),O(!0)}}),i.jsx(b,{formName:"range",value:s.displayValue,onChangeInput:B,resolvedAddress:a?a().getNames().getRanges.bind(a().getNames()):void 0,onFocus:e=>{T||e.target?.select(),O(!0)}})]})})});export{U as NamedReferenceDialog,U as default};
