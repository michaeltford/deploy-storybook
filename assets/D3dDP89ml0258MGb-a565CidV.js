import{j as l}from"./index-BiBgeh3u.js";import{r as s}from"./iframe-mGP4b_Fh.js";import{k as d}from"./index-CvKDCtrJ.js";import{O as P}from"./BgsyX5QL9OLy0DN3-CLQ3UbdE.js";import{B as V,F as M,T as S,b as O,g as F}from"./index-CdE0ylvR.js";import"./index-DTwpo8e8.js";import"./preload-helper-PPVm8Dsz.js";import"./client-BMu68Vok.js";import"./index-CmvF348R.js";import"./index-CXJVXQGg.js";import"./Tooltip-CXxmTuYg.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const $=["Ok","Cancel"],Q=s.memo(T=>{const{initialValue:k=null,onInput:g,context:w,onOption:f,onValidateOption:p,onDone:c,options:x=$,defaultOption:m=x?.[0],cancelOption:u="Cancel",sx:y,...b}=T,h=s.useMemo(()=>{const t=k??w?.()?.getComments();let o="";if(t&&t.content&&t.content.runs){const a=t.content.runs;for(let e=0;e<a.length;e++){const i=a[e];o+=i?.text}}return o},[]),[n,j]=s.useState(h),[v,B]=s.useState(!1),C=s.useCallback(async(t,o)=>null,[]),D=d(async t=>{const o=n===""?[]:n.split(`
`),a=t===u;if(!a){const e=o.length,i=new Array(e);for(let r=0;r<e;r++)i[r]={text:o[r]};g?.({content:{runs:i}})}f?.(t,a,t===m),c?.()},[n,g,c,f,m,u]),I=d(t=>{j(t.target.value),C(t.target.value,null)},[p]),E=d(async t=>{let o=await Promise.resolve(p?.(t));try{o!==!1&&(o=await C(n,t))}catch{}return o??!0},[p,n]);return l.jsx(P,{title:(h?"Edit":"Insert")+" Comments",options:x,onDone:c,onOption:t=>D(t),onValidateOption:E,defaultOption:m,cancelOption:u,autoFocusSel:".autoFocus",sx:{width:"480px",...y},...b,children:l.jsx(V,{sx:{paddingTop:t=>t.spacing(1),paddingBottom:t=>t.spacing(0),rowGap:t=>t.spacing(1),display:"flex",flexDirection:"column"},children:l.jsx(M,{sx:{paddingTop:t=>t.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:l.jsx(S,{label:"Comments",placeholder:"Enter a comment.",onFocus:t=>{v||t.target?.select(),B(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:t=>t.spacing(.5)}},slotProps:{inputLabel:{shrink:!0},htmlInput:{className:"autoFocus",spellCheck:!1,autoComplete:"off",sx:{paddingTop:t=>t.spacing(1.25),paddingBottom:t=>t.spacing(.75),backgroundImage:`linear-gradient(${O("#fff",F(5))}, ${O("#fff",F(5))})`}}},value:n,onChange:I,onContextMenu:t=>{t.stopPropagation()}})})})})});export{Q as CommentsDialog,Q as default};
