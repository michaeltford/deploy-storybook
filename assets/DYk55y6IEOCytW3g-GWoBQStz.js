import{j as o}from"./index-BiBgeh3u.js";import{r as a}from"./iframe-mGP4b_Fh.js";import{k as r,K as B}from"./index-CvKDCtrJ.js";import{O as R,M as E}from"./BgsyX5QL9OLy0DN3-CLQ3UbdE.js";import{B as j,F as z,T as K,b as p,g as u,a as L,S as V,d as A}from"./index-CdE0ylvR.js";import{w as H}from"./index-CmvF348R.js";import"./index-DTwpo8e8.js";import"./preload-helper-PPVm8Dsz.js";import"./client-BMu68Vok.js";import"./Tooltip-CXxmTuYg.js";import"./index-CXJVXQGg.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const N=["Autofit","Ok","Cancel"],ne=a.memo(v=>{const{initialValue:w,context:i,onOption:y,onValidateOption:c,onInput:O,onDone:m,options:C=N,defaultOption:l=C?.[1],cancelOption:d="Cancel",sx:T,...k}=v,F=a.useMemo(()=>i?.().getOrientation()===H.Orientation.Column,[i]),[n,b]=a.useState(w),[M,P]=a.useState(!1),x=a.useCallback(async(e,t)=>!0,[]),g=a.useMemo(()=>{if(!i().toUnits)return null;let e=n?.size??0,t="Px";return n.unit==="Px"?(e=i().toUnits?.(e),t=i().getUnitText()):(e=i().toPixels?.(e),t="Px"),{size:e,unit:t}},[n?.unit,n?.size]),f=r(async e=>{const t=e===d;t||O?.(n,e),y?.(e,t,e===l),m?.()},[n,O,m,y,d,l]),I=r(async e=>{e.keyCode===B.Enter&&await x?.(n,null)!==!1&&f(l)},[n,f]),D=r(async e=>{let t=await Promise.resolve(c?.(e));try{t!==!1&&(t=await Promise.resolve(x?.(n,e))??!0)}catch{}return t??!0},[c]),S=r(e=>{const t={...n,size:Number(e.target.value)};b(t),x?.(t,null)},[n,c]),U=r(e=>{const t=e.target.value,s={...n,unit:t};b(s)},[n]),$=a.useMemo(()=>{const e=i().getUnitText(),t=h=>o.jsx(E,{value:h,children:h},h),s=[];return s.push(t("Px")),s.push(t(e)),s},[]);return o.jsx(R,{title:"Resize "+(F?"Columns":"Rows"),options:C,onDone:m,onOption:e=>f(e),onValidateOption:D,defaultOption:l,cancelOption:d,autoFocusSel:".autoFocus",sx:{width:"380px",...T},...k,children:o.jsxs(j,{sx:{paddingTop:e=>e.spacing(0),paddingBottom:e=>e.spacing(1),display:"flex",flexDirection:"column"},children:[o.jsxs(j,{sx:{rowGap:e=>e.spacing(1),display:"flex",flexDirection:"row",gap:e=>e.spacing(.5),alignItems:"end",justifyContent:"center"},children:[o.jsx(z,{sx:{paddingTop:e=>e.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:o.jsx(K,{label:"Size",onFocus:e=>{M||e.target?.select(),P(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:e=>e.spacing(.5)}},slotProps:{inputLabel:{shrink:!0},htmlInput:{className:"autoFocus",spellCheck:!1,autoComplete:"off",type:"number",inputMode:"numeric",pattern:"[0-9]*",sx:{paddingTop:e=>e.spacing(1.25),paddingBottom:e=>e.spacing(.75),backgroundImage:`linear-gradient(${p("#fff",u(5))}, ${p("#fff",u(5))})`}}},value:n.size,onChange:S,onKeyDown:I,onContextMenu:e=>{e.stopPropagation()}})}),o.jsxs(z,{sx:{minWidth:85},size:"small",children:[o.jsx(L,{children:"Unit"}),o.jsx(V,{value:n.unit,label:"Unit",onChange:U,sx:{backgroundImage:`linear-gradient(${p("#fff",u(5))}, ${p("#fff",u(5))})`},children:$})]})]}),g&&o.jsx(j,{children:o.jsxs(A,{variant:"body2",component:"div",sx:{paddingLeft:e=>e.spacing(2)},children:[g.size," ",g.unit]})})]})})});export{ne as ResizeHeaderDialog,ne as default};
