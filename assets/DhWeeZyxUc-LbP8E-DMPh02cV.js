import{j as s}from"./index-BiBgeh3u.js";import{r as o}from"./iframe-mGP4b_Fh.js";import{k as f}from"./index-CvKDCtrJ.js";import{O as S}from"./BgsyX5QL9OLy0DN3-CLQ3UbdE.js";import{B as E,F as O,T as b,b as r,g as p}from"./index-CdE0ylvR.js";import"./index-DTwpo8e8.js";import"./preload-helper-PPVm8Dsz.js";import"./client-BMu68Vok.js";import"./index-CmvF348R.js";import"./index-CXJVXQGg.js";import"./Tooltip-CXxmTuYg.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const L=["Ok","Cancel"],Q=o.memo(F=>{const{initialValue:n=null,context:l,onInput:h,onOption:T,onValidateOption:u,onDone:d,options:y=L,defaultOption:c=y?.[0],cancelOption:g="Cancel",sx:j,...v}=F,w=o.useMemo(()=>(n??l?.()?.getHyperlink())!==null,[]),m=o.useMemo(()=>{let t=null,e=null;n&&(typeof n=="string"?e=n:t=n);const i=t??l?.()?.getHyperlink();return{address:e??i?.getAddress()??"",textToDisplay:i?.getDisplayText()??""}},[n,l]),[a,D]=o.useState(m.address),[x,I]=o.useState(()=>{const t=l?.().toTextUnformatted()??m.displayText;return t===m.address?"":t}),[M,k]=o.useState(!1),B=o.useCallback(t=>{I(t.target.value)},[]),C=o.useCallback(async(t,e)=>null,[]),H=f(async t=>{const e=a===""?null:{address:a},i=t===g;i||h?.({address:e?.address??null,displayText:x??null}),T?.(t,i,t===c),d?.()},[a,x,l,h,d,T,c,g]),P=f(t=>{D(t.target.value),C(t.target.value,null)},[u]),$=f(async t=>{let e=await Promise.resolve(u?.(t));try{e!==!1&&(e=await C(a,t))}catch{}return e??!0},[u]);return s.jsx(S,{title:(w?"Edit":"Insert")+" Link",options:y,onDone:d,onOption:t=>H(t),onValidateOption:$,defaultOption:c,cancelOption:g,autoFocusSel:".autoFocus",sx:{width:"480px",...j},...v,children:s.jsxs(E,{sx:{paddingTop:t=>t.spacing(1),paddingBottom:t=>t.spacing(0),rowGap:t=>t.spacing(1),display:"flex",flexDirection:"column"},children:[s.jsx(O,{sx:{paddingTop:t=>t.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:s.jsx(b,{label:"Address",placeholder:"Enter a url or cell reference.",onFocus:t=>{M||t.target?.select(),k(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:t=>t.spacing(.5)}},slotProps:{inputLabel:{shrink:!0},htmlInput:{className:"autoFocus",spellCheck:!1,autoComplete:"off",sx:{paddingTop:t=>t.spacing(1.25),paddingBottom:t=>t.spacing(.75),backgroundImage:`linear-gradient(${r("#fff",p(5))}, ${r("#fff",p(5))})`}}},value:a,onChange:P,onContextMenu:t=>{t.stopPropagation()}})}),s.jsx(O,{sx:{paddingTop:t=>t.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:s.jsx(b,{label:"Display Text",placeholder:a?.startsWith("#")?a.substring(1):a,onFocus:()=>{k(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:t=>t.spacing(.5)}},slotProps:{inputLabel:{shrink:!0},htmlInput:{spellCheck:!1,autoComplete:"off",sx:{paddingTop:t=>t.spacing(1.25),paddingBottom:t=>t.spacing(.75),backgroundImage:`linear-gradient(${r("#fff",p(5))}, ${r("#fff",p(5))})`}}},value:x,onChange:B,onContextMenu:t=>{t.stopPropagation()}})})]})})});export{Q as HyperlinkDialog,Q as default};
