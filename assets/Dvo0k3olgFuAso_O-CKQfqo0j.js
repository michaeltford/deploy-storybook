import{j as o}from"./index-BiBgeh3u.js";import{r as s}from"./iframe-mGP4b_Fh.js";import{H as n}from"./index-CmvF348R.js";import{k as p,K as L}from"./index-CvKDCtrJ.js";import{O as R,M as z}from"./BgsyX5QL9OLy0DN3-CLQ3UbdE.js";import{B as k,F,a as H,S as W,b as u,g as c,T as A,d as O}from"./index-CdE0ylvR.js";import"./index-DTwpo8e8.js";import"./preload-helper-PPVm8Dsz.js";import"./index-CXJVXQGg.js";import"./client-BMu68Vok.js";import"./Tooltip-CXxmTuYg.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.7.26
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const G=["Ok","Cancel"],oe=s.memo(S=>{const{initialValue:w,context:y,onOption:h,onValidateOption:m,onInput:b,onDone:d,options:C=G,defaultOption:i=C?.[0],cancelOption:g="Cancel",sx:$,...M}=S,[t,T]=s.useState(w),[D,I]=s.useState(!1),x=s.useCallback(async(e,a)=>!0,[]),f=p(async e=>{const a=e===g;a||b?.(t,e),h?.(e,a,e===i),d?.()},[t,b,d,h,g,i]),P=p(async e=>{e.keyCode===L.Enter&&await x?.(t,null)!==!1&&f(i)},[t,f]),B=p(e=>{T(e.target.value),x?.(e.target.value,null)},[m]),E=p(async e=>{let a=await Promise.resolve(m?.(e));try{a!==!1&&(a=await Promise.resolve(x?.(t,e))??!0)}catch{}return a??!0},[m]),[v,j]=s.useState(n.Styles.lookupStyle(t).formatType??n.Type.Custom);s.useEffect(()=>{j(n.Styles.lookupStyle(t).formatType??n.Type.Custom)},[t]);const N=s.useMemo(()=>{const e=n.Styles.lookupPrimary(),a=l=>o.jsx(z,{value:l,children:l},l),r=Object.keys(e).map(l=>a(e[l].formatType));return r.push(a(n.Type.Custom)),r},[]),V=s.useCallback(e=>{const a=e.target.value;j(a);const r=n.Styles.lookupDefault(a);r&&T(r)},[]),K=s.useMemo(()=>{const e=y?.();return e?e.createTemporaryCell({value:e.getValue()??12345,style:{numberFormat:t}}):null},[v,t,y]);return o.jsx(R,{title:"Number Format",options:C,onDone:d,onOption:e=>f(e),onValidateOption:E,defaultOption:i,cancelOption:g,autoFocusSel:".autoFocus",sx:{width:"580px",...$},...M,children:o.jsxs(k,{sx:{paddingTop:e=>e.spacing(1),paddingBottom:e=>e.spacing(0),rowGap:e=>e.spacing(1),display:"flex",flexDirection:"column"},children:[o.jsxs(F,{sx:{minWidth:135},size:"small",children:[o.jsx(H,{children:"Category"}),o.jsx(W,{value:v,label:"Category",onChange:V,sx:{backgroundImage:`linear-gradient(${u("#fff",c(5))}, ${u("#fff",c(5))})`},children:N})]}),o.jsx(F,{sx:{paddingTop:e=>e.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:o.jsx(A,{label:"Code",onFocus:e=>{D||e.target?.select(),I(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:e=>e.spacing(.5)}},slotProps:{inputLabel:{shrink:!0},htmlInput:{className:"autoFocus",spellCheck:!1,autoComplete:"off",sx:{paddingTop:e=>e.spacing(1.25),paddingBottom:e=>e.spacing(.75),backgroundImage:`linear-gradient(${u("#fff",c(5))}, ${u("#fff",c(5))})`}}},value:t,onChange:B,onKeyDown:P,onContextMenu:e=>{e.stopPropagation()}})}),o.jsxs(k,{children:[o.jsx(O,{variant:"caption",component:"div",sx:{paddingLeft:e=>e.spacing(2)},children:"Preview"}),o.jsx(O,{variant:"body2",component:"div",sx:{borderRadius:e=>`${e.shape.borderRadius}px`,padding:e=>e.spacing(1),border:e=>`1px solid ${e.palette.grey[400]}`},children:K?.getNumberFormat().displayText||"(empty)"})]})]})})});export{oe as NumberFormatDialog,oe as default};
