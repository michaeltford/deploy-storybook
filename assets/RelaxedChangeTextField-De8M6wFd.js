import{j as p}from"./index-BiBgeh3u.js";import{r as c}from"./iframe-mGP4b_Fh.js";import{c as B,K as F}from"./index-CvKDCtrJ.js";import{e as $,f as A,h as d,b as T,i as R,u as V,s as E,j as K,k as w,l as M,d as I,m as P,n as U,o as v,F as W,B as O,I as z,p as H,T as N}from"./index-CdE0ylvR.js";import{v as G}from"./index-CmvF348R.js";function _(e){return A("MuiLink",e)}const q=$("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),J=({theme:e,ownerState:n})=>{const o=n.color;if("colorSpace"in e&&e.colorSpace){const a=d(e,`palette.${o}.main`)||d(e,`palette.${o}`)||n.color;return e.alpha(a,.4)}const s=d(e,`palette.${o}.main`,!1)||d(e,`palette.${o}`,!1)||n.color,l=d(e,`palette.${o}.mainChannel`)||d(e,`palette.${o}Channel`);return"vars"in e&&l?`rgba(${l} / 0.4)`:T(s,.4)},h={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Q=e=>{const{classes:n,component:o,focusVisible:s,underline:l}=e,a={root:["root",`underline${w(l)}`,o==="button"&&"button",s&&"focusVisible"]};return M(a,_,n)},X=E(I,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,n[`underline${w(o.underline)}`],o.component==="button"&&n.button]}})(P(({theme:e})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:n,ownerState:o})=>n==="always"&&o.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},{props:({underline:n,ownerState:o})=>n==="always"&&o.color==="inherit",style:e.colorSpace?{textDecorationColor:e.alpha("currentColor",.4)}:null},...Object.entries(e.palette).filter(U()).map(([n])=>({props:{underline:"always",color:n},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette[n].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${q.focusVisible}`]:{outline:"auto"}}}]}))),Y=c.forwardRef(function(n,o){const s=R({props:n,name:"MuiLink"}),l=V(),{className:a,color:t="primary",component:i="a",onBlur:r,onFocus:x,TypographyClasses:f,underline:u="always",variant:b="inherit",sx:g,...m}=s,[D,k]=c.useState(!1),L=y=>{v(y.target)||k(!1),r&&r(y)},S=y=>{v(y.target)&&k(!0),x&&x(y)},C={...s,color:t,component:i,focusVisible:D,underline:u,variant:b},j=Q(C);return p.jsx(X,{color:t,className:K(j.root,a),classes:f,component:i,onBlur:L,onFocus:S,ref:o,ownerState:C,variant:b,...m,sx:[...h[t]===void 0?[{color:t}]:[],...Array.isArray(g)?g:[g]],style:{...m.style,...u==="always"&&t!=="inherit"&&!h[t]&&{"--Link-underlineColor":J({theme:l,ownerState:C})}}})}),te=c.memo(e=>{const{initialAddress:n,createWidget:o,workbook:s,refIWorkbookElement:l,...a}=e,[t,i]=c.useState(null),[r,x]=c.useState(null);G(s,t,u=>{x(u.getSource())});const f=c.useMemo(()=>o({range:r,refIWorkbookElement:l}),[r,o,l]);return p.jsxs(W,{...a,children:[p.jsxs(O,{sx:{display:"flex",flexDirection:"row",alignItems:"center",rowGap:u=>u.spacing(.25)},children:[f,p.jsx(z,{sx:{my:-2},disabled:!s,onClick:()=>{i(t===null?s.getSelectedCell().getA1():null)},children:p.jsx(B,{iconKey:"DataSetLinked"})})]}),p.jsx(H,{children:p.jsx(Y,{component:"button",underline:"hover",variant:"body2",disabled:r?.isInvalid(),sx:{"&:not(:hover)":{color:"inherit"},"&[disabled]":{color:u=>u.palette.text.disabled,cursor:"default","&:hover":{textDecoration:"none"}}},onClick:()=>{r.select()},children:r?`${r.toString()}`:"Unlinked"})})]})}),se=c.memo(e=>{const{value:n,onChange:o,onKeyDown:s,onBlur:l,...a}=e,[t,i]=c.useState(null);return c.useEffect(()=>{i(null)},[n]),p.jsx(N,{...a,value:t?.target.value??n??"",onKeyDown:r=>{r.which===F.Enter&&t&&(i(null),o?.(t),s?.(r))},onBlur:r=>{i(null),o?.(r),l?.(r)},onChange:r=>{i(r)}})});export{te as B,se as R};
